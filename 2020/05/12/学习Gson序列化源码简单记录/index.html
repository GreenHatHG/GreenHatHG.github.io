<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>学习Gson序列化源码简单记录 | GreenHatHGのBlog</title><meta name="author" content="GreenHatHg"><meta name="copyright" content="GreenHatHg"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="简单按照源码实现下「 List to JsonStr」。直接实现也很简单，不过为了锻炼下阅读源码的能力，还是练习跟踪下源码，找出大体框架，不沉迷细节，把握整体。   Gson的使用环境约定这里使用的 Java 环境，使用 Maven 管理依赖  Oracle..."><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "学习Gson序列化源码简单记录",
  "url": "https://greenhathg.github.io/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/",
  "image": "https://images.unsplash.com/photo-1620880762258-273a49958090?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1171&q=80",
  "datePublished": "2020-05-12T12:35:46.000Z",
  "dateModified": "2025-06-14T08:58:46.047Z",
  "author": [
    {
      "@type": "Person",
      "name": "GreenHatHg",
      "url": "https://greenhathg.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="https://avatars0.githubusercontent.com/u/34258355?s=460&u=eb0a1ce09dd045532464cb42f020e8ba1d025b6c&v=4"><link rel="canonical" href="https://greenhathg.github.io/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="&lt;meta name=&quot;google-site-verification&quot; content=&quot;eCt7WHUdmok7J0DG_5L1LtGFqZ_0DeC0ndMY3tBY_rQ&quot; /&gt;"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-116672888-1"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'UA-116672888-1')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'UA-116672888-1', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"已切换为繁体中文","cht_to_chs":"已切换为简体中文","day_to_night":"已切换为深色模式","night_to_day":"已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '学习Gson序列化源码简单记录',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="https://avatars0.githubusercontent.com/u/34258355?s=460&amp;u=eb0a1ce09dd045532464cb42f020e8ba1d025b6c&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">197</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">237</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/mood/"><i class="fa-fw fas fa-glass-cheers"></i><span> 自言自语</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://images.unsplash.com/photo-1620880762258-273a49958090?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">GreenHatHGのBlog</span></a><a class="nav-page-title" href="/"><span class="site-name">学习Gson序列化源码简单记录</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 目录</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/mood/"><i class="fa-fw fas fa-glass-cheers"></i><span> 自言自语</span></a></div><div class="menus_item"><a class="site-page" href="/message/"><i class="fa-fw fas fa-comment-dots"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">学习Gson序列化源码简单记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-05-12T12:35:46.000Z" title="发表于 2020-05-12 12:35:46">2020-05-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-14T08:58:46.047Z" title="更新于 2025-06-14 08:58:46">2025-06-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">2.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:500,&quot;messagePrev&quot;:&quot;已超过&quot;,&quot;messageNext&quot;:&quot;天未更新，某些文章具有时效性，若有错误或已失效，请反馈到greenhat2333@gamil.com&quot;,&quot;postUpdate&quot;:&quot;2025-06-14 08:58:46&quot;}" hidden></div><p>简单按照源码实现下「 List to JsonStr」。直接实现也很简单，不过为了锻炼下阅读源码的能力，还是练习跟踪下源码，找出大体框架，不沉迷细节，把握整体。 </p>
<span id="more"></span>
<h1 id="Gson的使用"><a href="#Gson的使用" class="headerlink" title="Gson的使用"></a>Gson的使用</h1><h2 id="环境约定"><a href="#环境约定" class="headerlink" title="环境约定"></a>环境约定</h2><p>这里使用的 Java 环境，使用 Maven 管理依赖</p>
<ul>
<li>Oracle JDK8</li>
</ul>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/1.png" alt></p>
<ul>
<li><p>Gson2.8.6</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">    &lt;groupId&gt;com.google.code.gson&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;gson&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;<span class="number">2.8</span><span class="number">.6</span>&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.google.gson.Gson;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> GreenHatHG</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2020-05-12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GsonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">double</span> grade;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(<span class="type">int</span> id, String name, <span class="type">double</span> grade)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.grade = grade;</span><br><span class="line">        &#125;</span><br><span class="line">		</span><br><span class="line">        <span class="comment">//getter方法省略</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Gson</span> <span class="variable">gson</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Gson</span>();</span><br><span class="line">        ArrayList&lt;Student&gt; students = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">2020</span>, <span class="string">&quot;李四&quot;</span>, <span class="number">78</span>));</span><br><span class="line">        students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3030</span>, <span class="string">&quot;王五&quot;</span>, <span class="number">85</span>));</span><br><span class="line">        students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">4040</span>, <span class="string">&quot;张三&quot;</span>, <span class="number">99</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> gson.toJson(students);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/2.png" alt></p>
<h1 id="跟踪过程"><a href="#跟踪过程" class="headerlink" title="跟踪过程"></a>跟踪过程</h1><h2 id="找到的第一个抽象write方法"><a href="#找到的第一个抽象write方法" class="headerlink" title="找到的第一个抽象write方法"></a>找到的第一个抽象write方法</h2><ol>
<li>查看 <code>gson.toJson(students)</code>的源码，位于<code>Gson.java</code></li>
</ol>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/3.png" alt></p>
<ol>
<li>这里面很明显， 615 行代码不会执行，转向 618 行的源码，位于<code>Gson.java</code>。</li>
</ol>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/4.png" alt></p>
<ol>
<li><p>这时候一看就是知道是 638 行代码执行起的序列化作用，该行源代码同样位于<code>Gson.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/5.png" alt></p>
</li>
<li><p>依旧点进去 683 行的源代码，位于<code>Gson.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/6.png" alt></p>
<p>一看代码有点多，但是主要部分还是容易看出来的</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/7.png" alt></p>
</li>
<li><p>所以可以直接跳到 704 行代码，位于<code>TypeAdapter.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/8.png" alt></p>
<p>从类名带 <code>Adapter</code> 来看，运用了适配器模式，这方面这里不展开</p>
<p>这里是抽象方法，我们不知道会调用了哪个实现了它的方法，所以我们可以打上断点去调试，然后开启调试</p>
</li>
</ol>
<h2 id="找到的第二个抽象write方法"><a href="#找到的第二个抽象write方法" class="headerlink" title="找到的第二个抽象write方法"></a>找到的第二个抽象write方法</h2><ol>
<li><p>根据上面开启调试，会立马定位到该方法，位于<code>CollectionTypeAdapterFactory.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/9.png" alt></p>
</li>
<li><p>为了搞明白，我们依旧得利用调试去查看每个方法的作用，首先在 95 行断点，按照这里来看，序列化的内容应该会输出在<code>out</code>这个变量里面，目前<code>out</code>变量里面的内容：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/10.png" alt></p>
<p>经过 95 行后，变成</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/11.png" alt></p>
<p>可见<code>out.beginArray();</code>和<code>out.endArray();</code>只是在序列化字符串前后加个<code>[ ]</code>，我们直接模拟实现即可</p>
</li>
<li><p>那么重点应该是 96 那里了，我们可以看<code>collection</code>变量里面的内容</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/12.png" alt></p>
<p>里面是我们之前创建的三个<code>Student</code>对象，那么自然 97 行代码也就是对每个对象进行序列化了</p>
</li>
<li><p>点进去后同样跳到了抽象的<code>write</code>方法，位于<code>TypeAdapter.java</code>，用同样的加断点方法进行调试</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/13.png" alt></p>
</li>
</ol>
<h2 id="找到的第三个抽象write方法"><a href="#找到的第三个抽象write方法" class="headerlink" title="找到的第三个抽象write方法"></a>找到的第三个抽象write方法</h2><ol>
<li><p>根据上面调试，跳到如下位置，位于<code>TypeAdapterRuntimeTypeWrapper.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/14.png" alt></p>
<p>这时候我们可以选择直接断点在 69 行，查看序列化字符串变化情况。现在断点在 53 行的情况：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/15.png" alt></p>
<p>待程序执行到 69 行，<code>out</code>变量里面的内容依旧没有变化</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/16.png" alt></p>
<p>那么可以确定序列化代码在 69 行了。</p>
</li>
<li><p>点进 69 行代码，位于<code>TypeAdapter.java</code>，如下：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/17.png" alt></p>
<p>这时候我们可以看到其实每次调用的这些的抽象<code>write</code>方法都是一样的，但是实现类却不一样，每个都有自己的功能。</p>
<p><del>这个过程就好像套娃一样，老千层饼了</del></p>
<p>那么依旧断点在 127 行这个抽象的<code>write</code>方法，为了避免其他的断点的干扰，以及方便跳到我们想要的地方，我们可以把其他断点去掉先，选择后按<code>delete</code>键可以删除</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/18.png" alt></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/20.png" alt></p>
<p>然后我们再给 127 行打上断点</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/21.png" alt></p>
<p><strong>当然上面只是一种方法，要是你觉得这种方法比较麻烦，你可以直接按下面的红色小箭头直接进入源码，省去断点在接口的麻烦，但是这样就略去了接口的细节</strong></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/22.png" alt></p>
<p>FAQ：为什么不点蓝色箭头？</p>
<p>因为蓝色那个有的地方跳不进去</p>
</li>
</ol>
<h2 id="2020-years-later"><a href="#2020-years-later" class="headerlink" title="2020 years later"></a>2020 years later</h2><ol>
<li><p>根据上面，跳到<code>ObjectTypeAdapter.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/23.png" alt></p>
<p>这时候我们可以判断程序有没有执行 101 行里面的内容，<code>Step over F8</code>走下去，发现并没有进去，那么也就说，又到了我们最喜欢的抽象<code>write</code>方法环节了，emmm，点进去一如既往：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/17.png" alt></p>
<p>为了方便，就不调试断点，直接<code>Step into</code>进去</p>
</li>
<li><p>进到<code>ReflectiveTypeAdapterFactory.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/24.png" alt></p>
<p>同样我们需要确定 240 行的作用，先查看现在<code>out</code>变量的内容：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/25.png" alt></p>
<p>执行完 240 行后</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/26.png" alt></p>
<p>可以看到 240 行作用只不过是添加个<code>&#123;</code>而已，但是绝对不是直接添加<code>&#123;</code>那么简单</p>
<p>自然 251 行作用就是添加个<code>&#125;</code></p>
</li>
<li><p>然后接着<code>step over</code>执行到 244 行，为了确定 244 行作用，我们选择的做法依旧是先执行查看结果后再决定要不要<code>step into</code>进去。</p>
<p>这里 244 行并没有什么变化，反而是执行了 245 行后有变化了</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/27.png" alt></p>
</li>
</ol>
<h2 id="找到序列化属性名的代码"><a href="#找到序列化属性名的代码" class="headerlink" title="找到序列化属性名的代码"></a>找到序列化属性名的代码</h2><ol>
<li><p>进入到 245 行后的代码，位于<code>ReflectiveTypeAdapterFactory.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/28.png" alt></p>
</li>
<li><p>同样为了确定主要代码部分，先让程序执行到 127 行</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/29.png" alt></p>
<p>那么就可以确定是 127 行代码是主要部分，跳进去，又是一次套娃，emmm，这个我们在「找到第三个抽象write方法」那里就有出现过</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/14.png" alt></p>
<p>这里我们选择的是<code>step over</code>一步步进行，同时查看<code>out</code>方法的变化</p>
<p><code>step over</code>后，发现程序执行到 69 行<code>out</code>变量还没有变化，那么同样使用<code>step into</code>进去 69 行后，位于<code>TypeAdapters.java</code>，断点调试这行语句</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/30.png" alt></p>
<p>发现<code>out</code>变量内容由<code>[&#123;</code>变成了<code>[&#123;&quot;id&quot;:2020</code>，那么自然得进去看这个代码</p>
</li>
<li><p>调试 233 行，源码进入到<code>JsonWriter.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/31.png" alt></p>
<p>待执行完 526 行，序列化字符串内容添加了个<code>&quot;id&quot;</code></p>
</li>
</ol>
<h2 id="简单分析写入属性名"><a href="#简单分析写入属性名" class="headerlink" title="简单分析写入属性名"></a>简单分析写入属性名</h2><ol>
<li><p>调试 526 行代码，源码位于<code>JsonWriter.java</code></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/32.png" alt></p>
<p>​    这里可以看到<code>defferredName</code>的值为<code>id</code>，那么 401 行代码自然就是将其写入到序列化字符串中</p>
</li>
<li><p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/33.png" alt></p>
<p>这里是有做了字符串替换处理，会将一些特殊字符转换为unicode编程格式。</p>
<p><code>replacements</code>正是一系列代替规则，<code>htmlSafe</code>是默认为<code>true</code>，替换规则默认如下：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/34.png" alt></p>
<p>​    写入序列化字符串的过程，比如 592 行，使用了<code>synchronized</code>进行加锁，<code>lock</code>变量是个<code>Object</code>的实例</p>
<p>​    <img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/35.png" alt></p>
<p>​    </p>
</li>
</ol>
<h3 id="htmlSafe是在哪里置为true的"><a href="#htmlSafe是在哪里置为true的" class="headerlink" title="htmlSafe是在哪里置为true的"></a>htmlSafe是在哪里置为true的</h3><p>我们先在原地方<code>JsonWrite.java</code>查看<code>htmlSafe</code>变量的使用情况</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/36.png" alt></p>
<p>发现有个<code>htmlSafe</code>属性，我们把其他的断点情况，将断点断在属性上面，运行debug</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/37.png" alt></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/38.png" alt></p>
<p>可以看到是有地方调了<code>setHtmlSafe</code>方法将其置为true</p>
<p>查看该方法的使用情况，发现在<code>Gson.java</code>有地方调用了该方法</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/39.png" alt></p>
<p>碰巧第 700 行有个<code>htmlSafe</code>变量，接着一样是查看该变量使用情况，然后定位到<code>Gson.java</code>也有个<code>htmlSafe</code>的变量，同样断点该变量</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/40.png" alt></p>
<p>发现这里有个构造函数，给该变量赋值为true，正好是使用默认构造函数创建<code>Gson</code>对象的时候会将<code>htmlSafe</code>变为true</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/41.png" alt></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/42.png" alt></p>
<h2 id="找到序列化属性值的代码"><a href="#找到序列化属性值的代码" class="headerlink" title="找到序列化属性值的代码"></a>找到序列化属性值的代码</h2><p>上面我们看到，在<code>JsonWrite.java</code>里面的 526 行，作用是序列化上属性名，我们接着执行</p>
<p>执行到 532 行代码，这个函数作用是给序列化字符串加个”:”</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/43.png" alt></p>
<p>那么，当我们执行玩 533 行时，就已经序列化好了属性名和属性值</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/44.png" alt></p>
<h2 id="是如何获取属性名和属性值的"><a href="#是如何获取属性名和属性值的" class="headerlink" title="是如何获取属性名和属性值的"></a>是如何获取属性名和属性值的</h2><p>在上面，我们在 521 行这个函数中得到了一个value值，这个是属性值，但是它是怎么得到的呢</p>
<p>我们可以查看这个函数的调用链：</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/45.png" alt></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/46.png" alt></p>
<p>从第一个函数来看，看不到什么</p>
<p>当我们查看第二个函数时，发现有个<code>deferredName</code>可疑，于是debug一下，正好这个值就是属性名，那么接下来我们需要得知它是如何被赋值的</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/47.png" alt></p>
<p><code>Find Usages</code>后，发现是个<code>JsonWrite</code>的一个属性，于是我们按照之前的方法给属性断点</p>
<p>然后断点停在了<code>JsonWriter.java</code>里</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/48.png" alt></p>
<p>很显然，我们需要知道这个<code>name</code>如何来，查看调用链</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/49.png" alt></p>
<p>这里找到一个比较可疑的变量<code>boundField</code>，位于<code>ReflectiveTypeAdapterFactory.java</code>，之所以说是可疑，因为它对比其他的变量特征显著，起码类型不是泛型，而是个具体的。</p>
<p>一看，在 201 行有被用到</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/50.png" alt></p>
<p>查看 201 行那个函数的使用情况，找到如下</p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/51.png" alt></p>
<p><img src="/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/52.png" alt></p>
<p>这里看到，有好几处运用到了反射，比如 152 166等行，再结合反射特点，所以推断出应该是用反射获得到属性值和属性名的</p>
<h1 id="简单实现"><a href="#简单实现" class="headerlink" title="简单实现"></a>简单实现</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">int</span> id;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> <span class="type">double</span> grade;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(<span class="type">int</span> id, String name, <span class="type">double</span> grade)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.id = id;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.grade = grade;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">getGrade</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> grade;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">studentListToJson</span><span class="params">(List&lt;Student&gt; studentList)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        <span class="comment">//beginArray</span></span><br><span class="line">        sb.append(<span class="string">&quot;[&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; studentList.size(); i++)&#123;</span><br><span class="line">            <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> studentList.get(i);</span><br><span class="line"></span><br><span class="line">            sb.append(<span class="string">&quot;&#123;&quot;</span>);</span><br><span class="line">            <span class="comment">//绑定当前student对象的属性名和值</span></span><br><span class="line">            Map&lt;String, Object&gt; boundField = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">            <span class="comment">//获取属性名和值</span></span><br><span class="line">            <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> student.getClass();</span><br><span class="line">            Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">            <span class="keyword">for</span> (Field field : fields)&#123;</span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                <span class="type">String</span> <span class="variable">fieldName</span> <span class="operator">=</span> field.getName();</span><br><span class="line"></span><br><span class="line">                <span class="type">String</span> <span class="variable">methodName</span> <span class="operator">=</span> <span class="string">&quot;get&quot;</span>+fieldName.substring(<span class="number">0</span>,<span class="number">1</span>)</span><br><span class="line">                    .toUpperCase()+fieldName.substring(<span class="number">1</span>);</span><br><span class="line">                <span class="type">Method</span> <span class="variable">method</span> <span class="operator">=</span> clazz.getMethod(methodName, <span class="literal">null</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">fieldValue</span> <span class="operator">=</span> method.invoke(student, <span class="literal">null</span>);</span><br><span class="line">                boundField.put(fieldName, fieldValue);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">boolean</span>[] internalFirst = &#123;<span class="literal">true</span>&#125;;</span><br><span class="line">            boundField.forEach((k,v) -&gt;&#123;</span><br><span class="line">                <span class="keyword">if</span>(!internalFirst[<span class="number">0</span>])&#123;</span><br><span class="line">                    sb.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                sb.append(<span class="string">&quot;\&quot;&quot;</span>).append(k).append(<span class="string">&quot;\&quot;&quot;</span>).append(<span class="string">&quot;:&quot;</span>);</span><br><span class="line">                <span class="keyword">if</span>(v <span class="keyword">instanceof</span> Number)&#123;</span><br><span class="line">                    sb.append(v);</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    sb.append(<span class="string">&quot;\&quot;&quot;</span>).append(v).append(<span class="string">&quot;\&quot;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                internalFirst[<span class="number">0</span>] = <span class="literal">false</span>;</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            sb.append(<span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(i != studentList.size() - <span class="number">1</span>)&#123;</span><br><span class="line">                sb.append(<span class="string">&quot;,&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//endArray</span></span><br><span class="line">        sb.append(<span class="string">&quot;]&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        List&lt;Student&gt; students = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Student&gt;();</span><br><span class="line">        students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">1</span>,<span class="string">&quot;11&quot;</span>, <span class="number">1.11</span>));</span><br><span class="line">        students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">2</span>,<span class="string">&quot;22&quot;</span>, <span class="number">2.22</span>));</span><br><span class="line">        students.add(<span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">3</span>,<span class="string">&quot;33&quot;</span>, <span class="number">3.33</span>));</span><br><span class="line">        System.out.println(Main.studentListToJson(students));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://greenhathg.github.io">GreenHatHg</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://greenhathg.github.io/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/">https://greenhathg.github.io/2020/05/12/%E5%AD%A6%E4%B9%A0Gson%E5%BA%8F%E5%88%97%E5%8C%96%E6%BA%90%E7%A0%81%E7%AE%80%E5%8D%95%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://greenhathg.github.io" target="_blank">GreenHatHGのBlog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%BA%90%E7%A0%81/">源码</a><a class="post-meta__tags" href="/tags/gson/">gson</a></div><div class="post-share"><div class="social-share" data-image="https://images.unsplash.com/photo-1620880762258-273a49958090?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2020/06/06/Java%E6%89%A7%E8%A1%8CShell%E5%91%BD%E4%BB%A4%E7%AC%94%E8%AE%B0/" title="Java执行Shell命令笔记"><img class="cover" src="https://images.unsplash.com/photo-1620880762272-c2bf6b4f1ce2?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">Java执行Shell命令笔记</div></div><div class="info-2"><div class="info-item-1">ProcessBuilder类浅析以及Linux Shell执行逻辑  从Java代码运行Shell命令有两种方式  使用Runtime类的exec方法 第二种是使用ProcessBuilder类  使用第二种方法能够定制更多的内容，本文主要介绍的是第二种，第一种介绍下用法 环境约定：  Arch Linux x86_64 Linux 5.4.44-1-lts java version &quot;1.8.0_251&quot; Java HotSpot(TM) 64-Bit Server VM (build 25.251-b08, mixed mode)  Runtime123456789101112public void runTime() throws IOException, InterruptedException &#123;    //在单独的进程中执行指定的字符串命令（产生一个新的子进程）    Process process = Runtime.getRuntime().exec(&quot;ls -al&quot;);   ...</div></div></div></a><a class="pagination-related" href="/2020/02/11/bookmarks/" title="自用书签（移至notion更新！）"><img class="cover" src="https://images.unsplash.com/photo-1618170673668-0eea9c66d40c?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">自用书签（移至notion更新！）</div></div><div class="info-2"><div class="info-item-1">UpdateTime: 2020/03/12  DockerDocker —— 从入门到实践 · GitBook (Legacy) 创建尽可能小的 Docker 容器 - yexiaoxiaobai - SegmentFault 思否 查看 docker 容器使用的资源 - sparkdev - 博客园 使用 docker 对容器资源进行限制 | Cizixs Write Here [求助]docker build 速度非常慢 - V2EX Hexohexo的next主题个性化教程:打造炫酷网站 | Moorez 手把手教你使用Hexo + Github Pages搭建个人独立博客 | 令狐葱@前端笔记 HEXO+NEXT主题个性化配置 | SORA Hexo博客NexT主题从v5.x.x更新到v6.x.x的记录及总结 | 曹雪松de博客|CoderBoy’s Blog 如何在 hexo 中支持 Mathjax？ - 简书 常用数学符号的 LaTeX 表示方法 超详细Hexo+Github博客搭建小白教程 | 韦阳的博客 MathJax使用LaTeX语法编写数学公式教程 -...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2019/05/04/Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AC%94%E8%AE%B0-ClassLoder%E9%83%A8%E5%88%86%E6%96%87%E6%A1%A3%E8%A7%A3%E8%AF%BB/" title="Java虚拟机笔记-ClassLoder部分文档解读"><img class="cover" src="https://images.unsplash.com/photo-1620880762258-273a49958090?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1171&q=80" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-06-14</div><div class="info-item-2">Java虚拟机笔记-ClassLoder部分文档解读</div></div><div class="info-2"><div class="info-item-1">ClassLoder部分文档解读  Documentation123java.lang public abstract class ClassLoaderextends Object  123A class loader is an object that is responsible for loading classes. The class ClassLoader is an abstract class. Given the binary name of a class, a class loader should attempt to locate or generate data that constitutes a definition for the class. A typical strategy is to transform the name into a file name and then read a &quot;class file&quot; of that name from a file...</div></div></div></a><a class="pagination-related" href="/2019/06/02/Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AC%94%E8%AE%B0-Launcher%E7%B1%BB/" title="Java虚拟机笔记-Launcher类"><img class="cover" src="https://images.unsplash.com/photo-1621761836815-6e43911fbcfc?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1171&q=80" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-06-14</div><div class="info-item-2">Java虚拟机笔记-Launcher类</div></div><div class="info-2"><div class="info-item-1">Launcher类部分内容分析  三种类加载器之间的关系 内建于JVM中的启动类加载器会加载java.lang.ClassLoder以及其他Java平台类，当JVM启动时，一块特殊的机器码会运行，它会加载扩展类加载器与系统类加载器，这块特殊的机器码叫做启动类加载器（Bootstrap）。  启动类加载器不是Java类，而其他的加载器则都是Java类，启动类加载器是特定于平台的机器指令，它负责开启整个过程。  所有类加载器（除了启动类加载器）都被实现为Java类。不过，总归要有一个组件来加载第一个Java类加载器，从而让整个加载过程能够顺利进行下去，加载第一个纯Java类加载器就是启动类加载器的职责。  启动类加载器还会负责加载供JRE正常运行所需要的基本组件，这包括java.util与java.lang包中的类等等。   验证12System.out.println(ClassLoader.class.getClassLoader());//输出null 但是不能直接获取扩展类加载器和系统类加载器，因为没有声明这两个类为public 12345678910public...</div></div></div></a><a class="pagination-related" href="/2019/06/11/Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AC%94%E8%AE%B0-ServiceLoader/" title="Java虚拟机笔记-ServiceLoader"><img class="cover" src="https://images.unsplash.com/photo-1619075120066-02024cb853bd?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1171&q=80" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-06-14</div><div class="info-item-2">Java虚拟机笔记-ServiceLoader</div></div><div class="info-2"><div class="info-item-1">ServiceLoader-javaDoc  1234567891011121314151617181920package indi.greenhat.jvm;import java.sql.Driver;import java.sql.DriverManager;import java.util.Iterator;import java.util.ServiceLoader;public class Test &#123;    public static void main(String[] args) throws Exception &#123;        ServiceLoader&lt;Driver&gt; loader = ServiceLoader.load(Driver.class);        Iterator&lt;Driver&gt; iterator = loader.iterator();        while (iterator.hasNext()) &#123;            Driver driver =...</div></div></div></a><a class="pagination-related" href="/2019/05/29/Java%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%AC%94%E8%AE%B0-getProperty/" title="Java虚拟机笔记-getProperty"><img class="cover" src="https://images.unsplash.com/photo-1621761836815-6e43911fbcfc?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1171&q=80" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="fas fa-history fa-fw"></i> 2025-06-14</div><div class="info-item-2">Java虚拟机笔记-getProperty</div></div><div class="info-2"><div class="info-item-1">System.getProperty System.getProperty()参考：https://www.jianshu.com/p/9b262628e041 123456789101112131415161718package indi.greenhat.jvm;public class Test &#123;    public static void main(String[] args) throws Exception&#123;        /**         * 获取指定键指示的系统属性         * 首先，如果存在安全管理器，会调用其checkPropertiesAccess无参方法，有可能抛出安全异常         * 当前系统属性集会通过Property对象返回（对象有getProperty()方法）         * 如果当前没有系统属性集，会创建并初始化系统属性集。         */        //获得根类加载器系统属性       ...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="https://avatars0.githubusercontent.com/u/34258355?s=460&amp;u=eb0a1ce09dd045532464cb42f020e8ba1d025b6c&amp;v=4" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">GreenHatHg</div><div class="author-info-description">巴拉巴拉能量! rm -rf / --no-preserve-root</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">197</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">237</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/GreenHatHG"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/GreenHatHG" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:greenhat2333@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Gson%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">Gson的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E7%BA%A6%E5%AE%9A"><span class="toc-number">1.1.</span> <span class="toc-text">环境约定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="toc-number">1.2.</span> <span class="toc-text">使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B7%9F%E8%B8%AA%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">跟踪过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%8A%BD%E8%B1%A1write%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">找到的第一个抽象write方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E6%8A%BD%E8%B1%A1write%E6%96%B9%E6%B3%95"><span class="toc-number">2.2.</span> <span class="toc-text">找到的第二个抽象write方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E7%9A%84%E7%AC%AC%E4%B8%89%E4%B8%AA%E6%8A%BD%E8%B1%A1write%E6%96%B9%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text">找到的第三个抽象write方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2020-years-later"><span class="toc-number">2.4.</span> <span class="toc-text">2020 years later</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E5%BA%8F%E5%88%97%E5%8C%96%E5%B1%9E%E6%80%A7%E5%90%8D%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">2.5.</span> <span class="toc-text">找到序列化属性名的代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%88%86%E6%9E%90%E5%86%99%E5%85%A5%E5%B1%9E%E6%80%A7%E5%90%8D"><span class="toc-number">2.6.</span> <span class="toc-text">简单分析写入属性名</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#htmlSafe%E6%98%AF%E5%9C%A8%E5%93%AA%E9%87%8C%E7%BD%AE%E4%B8%BAtrue%E7%9A%84"><span class="toc-number">2.6.1.</span> <span class="toc-text">htmlSafe是在哪里置为true的</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%BE%E5%88%B0%E5%BA%8F%E5%88%97%E5%8C%96%E5%B1%9E%E6%80%A7%E5%80%BC%E7%9A%84%E4%BB%A3%E7%A0%81"><span class="toc-number">2.7.</span> <span class="toc-text">找到序列化属性值的代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%98%AF%E5%A6%82%E4%BD%95%E8%8E%B7%E5%8F%96%E5%B1%9E%E6%80%A7%E5%90%8D%E5%92%8C%E5%B1%9E%E6%80%A7%E5%80%BC%E7%9A%84"><span class="toc-number">2.8.</span> <span class="toc-text">是如何获取属性名和属性值的</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">简单实现</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/14/Xueqiu_Forever-summary-2025-06-14/" title="[Xueqiu_Forever] 发言时段总结 - 2025-06-14"><img src="https://images.unsplash.com/photo-1619342802099-027bc73e30eb?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[Xueqiu_Forever] 发言时段总结 - 2025-06-14"/></a><div class="content"><a class="title" href="/2025/06/14/Xueqiu_Forever-summary-2025-06-14/" title="[Xueqiu_Forever] 发言时段总结 - 2025-06-14">[Xueqiu_Forever] 发言时段总结 - 2025-06-14</a><time datetime="2025-06-14T08:58:33.000Z" title="发表于 2025-06-14 08:58:33">2025-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/14/Xueqiu_ShanXing-summary-2025-06-14/" title="[Xueqiu_ShanXing] 发言时段总结 - 2025-06-14"><img src="https://images.unsplash.com/photo-1618170673668-0eea9c66d40c?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="[Xueqiu_ShanXing] 发言时段总结 - 2025-06-14"/></a><div class="content"><a class="title" href="/2025/06/14/Xueqiu_ShanXing-summary-2025-06-14/" title="[Xueqiu_ShanXing] 发言时段总结 - 2025-06-14">[Xueqiu_ShanXing] 发言时段总结 - 2025-06-14</a><time datetime="2025-06-14T08:15:28.000Z" title="发表于 2025-06-14 08:15:28">2025-06-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/05/CMU445-Project2-BPlusTree-Delete-Single-Threaded/" title="CMU445-Project2-BPlusTree-Delete-Single-threaded"><img src="https://images.unsplash.com/photo-1620880762296-f9787c134352?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;ixlib=rb-1.2.1&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CMU445-Project2-BPlusTree-Delete-Single-threaded"/></a><div class="content"><a class="title" href="/2024/01/05/CMU445-Project2-BPlusTree-Delete-Single-Threaded/" title="CMU445-Project2-BPlusTree-Delete-Single-threaded">CMU445-Project2-BPlusTree-Delete-Single-threaded</a><time datetime="2024-01-05T12:39:43.000Z" title="发表于 2024-01-05 12:39:43">2024-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/31/%E7%8E%A9%E5%AE%A2%E4%BA%91%E6%8D%A2%E9%AD%94%E7%99%BE%E7%9B%92/" title="玩客云换魔百盒"><img src="https://images.unsplash.com/photo-1620880762258-273a49958090?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="玩客云换魔百盒"/></a><div class="content"><a class="title" href="/2023/12/31/%E7%8E%A9%E5%AE%A2%E4%BA%91%E6%8D%A2%E9%AD%94%E7%99%BE%E7%9B%92/" title="玩客云换魔百盒">玩客云换魔百盒</a><time datetime="2023-12-31T12:44:43.000Z" title="发表于 2023-12-31 12:44:43">2023-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/12/CMU445-Project2-BPlusTree-Insert/" title="CMU445-Project1-BPlusTree-Insert-Single-threaded"><img src="https://images.unsplash.com/photo-1619075120066-02024cb853bd?ixlib=rb-1.2.1&amp;ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&amp;auto=format&amp;fit=crop&amp;w=1171&amp;q=80" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CMU445-Project1-BPlusTree-Insert-Single-threaded"/></a><div class="content"><a class="title" href="/2023/12/12/CMU445-Project2-BPlusTree-Insert/" title="CMU445-Project1-BPlusTree-Insert-Single-threaded">CMU445-Project1-BPlusTree-Insert-Single-threaded</a><time datetime="2023-12-12T22:59:43.000Z" title="发表于 2023-12-12 22:59:43">2023-12-12</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2018 - 2025 By GreenHatHg</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://blog-twikoo-khaki.vercel.app',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://blog-twikoo-khaki.vercel.app',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    GLOBAL_CONFIG_SITE.pageType === 'post' && getCount()

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="true" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>